config {
schema: "dataform_assertions"
}


-- Example: ensure we have purchases in last 7 days
assert("purchases_last_7_days_non_zero", {
query: () => `
SELECT COUNT(1) AS cnt FROM \`deft-landing-478816-i6.dataform.silver_purchase_traffic_source_medium\`
WHERE PARSE_DATE('%Y%m%d', event_date) BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL